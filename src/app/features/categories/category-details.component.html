<section class="min-h-screen bg-gradient-to-b from-[#0c021a] via-[#1a0f2d] to-[#251a3f] text-gray-100 pt-28 md:pt-32 pb-16">
  <div class="container mx-auto px-4">
    <!-- Categories Slider (navigate between categories) -->
    @if (categories.length) {
      <div class="mb-8">
        <h2 class="text-2xl md:text-3xl font-bold text-white mb-4 tracking-wide text-center md:text-left">
          Explore Featured Categories
        </h2>
        <owl-carousel-o [options]="categorySliderOptions">
          @for (c of categories; track c._id) {
            <ng-template carouselSlide>
              <a [routerLink]="['/categories', c._id]" class="block group">
                <div class="overflow-hidden rounded-xl border border-white/10 bg-white/5 backdrop-blur-sm">
                  <img [src]="c.image" [alt]="c.name" class="w-full h-28 object-cover transition duration-700 group-hover:scale-110" />
                </div>
                <div class="mt-2 text-center text-white/80 text-sm group-hover:text-violet-300 transition">{{ c.name }}</div>
              </a>
            </ng-template>
          }
        </owl-carousel-o>
      </div>
    }
    @if (category) {
      <div class="mb-8 flex items-center gap-4">
        <img [src]="category.image" [alt]="category.name" class="w-16 h-16 object-cover rounded-lg border border-white/10" />
        <h1 class="text-2xl md:text-3xl font-bold text-white">{{ category.name }}</h1>
      </div>
    }

    @if (isLoading) {
      <div class="flex items-center justify-center py-20">
        <i class="fas fa-spinner fa-spin text-violet-300 text-2xl"></i>
      </div>
    }

    @if (!isLoading && products.length === 0) {
      <div class="text-center py-20 text-white/80">No products were found for this category.</div>
    }

    @if (!isLoading && products.length > 0) {
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
        @for (p of products; track p._id) {
          <div (click)="onProductClick(p._id)"
            class="group bg-white/5 border border-white/10 rounded-xl overflow-hidden hover:shadow-xl hover:shadow-violet-900/20 transition-all duration-500 cursor-pointer">
            <div class="relative aspect-square overflow-hidden">
              <img [src]="p.imageCover" [alt]="p.title" class="w-full h-full object-cover transition duration-700 group-hover:scale-105" />
              <!-- Quick Actions -->
              <div class="absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-all duration-300 flex items-center justify-center gap-4">
                <button (click)="onAddToCart(p._id, p.title); $event.stopPropagation()"
                  class="p-3 rounded-full cursor-pointer bg-[#1b1330]/90 hover:bg-violet-700 text-white shadow-md transition-all duration-300">
                  <i class="fas fa-shopping-cart"></i>
                </button>
                <button (click)="onAddToWishlist(p, p.title); $event.stopPropagation()"
                  class="p-3 rounded-full cursor-pointer bg-[#1b1330]/90 hover:bg-violet-700 text-white shadow-md transition-all duration-300">
                  <i class="fa-heart" [ngClass]="isWishlisted(p._id) ? 'fas text-rose-400' : 'far text-violet-200'"></i>
                </button>
              </div>
            </div>
            <div class="p-4">
              <div class="font-medium text-white mb-1 line-clamp-1">{{ p.title }}</div>
              <div class="flex items-center gap-1 mb-2">
                @for (i of [1,2,3,4,5]; track i) {
                  <i class="fas fa-star text-sm" [attr.style]="starFill(p.ratingsAverage, i)"></i>
                }
                <span class="text-xs text-gray-300 ml-1">{{ p.ratingsAverage?.toFixed(1) || '—' }}</span>
              </div>
              <div class="flex items-center justify-between">
                <span class="text-violet-300 font-semibold">${{ p.price }}</span>
                <span class="text-sm text-violet-300 group-hover:text-violet-200">View →</span>
              </div>
            </div>
          </div>
        }
      </div>
    }
  </div>
</section>
