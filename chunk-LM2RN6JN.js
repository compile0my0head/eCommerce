import{a as B}from"./chunk-Z3TLLND5.js";import{a as j,b as _,c as H,d as U,e as X,f as O,h as $,i as G,j as L,l as q}from"./chunk-3CLL7LMM.js";import{a as w}from"./chunk-SZXLN6HP.js";import{A,Aa as l,Ba as v,H as x,I as g,Ia as P,W as a,ca as c,ea as k,gb as F,ha as y,ia as m,ib as R,ka as T,la as D,ma as n,na as t,oa as s,qb as V,ra as C,sa as p,sb as N,ta as f,v as I,y as M,z as h}from"./chunk-ABLYTEQI.js";import"./chunk-EQDQRRRY.js";var S=class i{constructor(e){this._HttpClient=e}myHeaders={token:localStorage.getItem("userToken")};checkOut(e,o){return this._HttpClient.post(`${w.baseUrl}/api/v1/orders/checkout-session/${e}?url=${w.serverUrl}`,{shippingAddress:o},{headers:this.myHeaders})}cashOnDelivery(e,o){return this._HttpClient.post(`${w.baseUrl}/api/v1/orders/${e}`,{shippingAddress:o},{headers:this.myHeaders})}static \u0275fac=function(o){return new(o||i)(M(R))};static \u0275prov=I({token:i,factory:i.\u0275fac,providedIn:"root"})};var z=(i,e)=>e._id;function J(i,e){i&1&&s(0,"i",45)}function K(i,e){if(i&1){let o=C();n(0,"div",35),p("click",function(){let d=x(o).$implicit,u=f(2);return g(u.selectAddress(d))}),n(1,"div",36)(2,"div",37),s(3,"i",38),t(),n(4,"div",39)(5,"h4",40),l(6),t(),n(7,"p",41),l(8),t(),n(9,"div",42)(10,"span"),s(11,"i",43),l(12),t(),n(13,"span"),s(14,"i",44),l(15),t()()(),c(16,J,1,0,"i",45),t()()}if(i&2){let o=e.$implicit,r=f(2);y(r.selectedAddressId===o._id?"bg-violet-600/20 border-violet-500":"bg-white/5 border-white/10 hover:border-violet-500/50"),a(6),v(o.name),a(2),v(o.details),a(4),v(o.city),a(3),v(o.phone),a(),m(r.selectedAddressId===o._id?16:-1)}}function Q(i,e){if(i&1){let o=C();n(0,"div",8)(1,"div",30)(2,"h3",31),l(3,"Choose a saved address"),t(),n(4,"button",32),p("click",function(){x(o);let d=f();return g(d.toggleManualEntry())}),l(5," Enter manually \u2192 "),t()(),n(6,"div",33),T(7,K,17,7,"div",34,z),t()()}if(i&2){let o=f();a(7),D(o.addressesList)}}function W(i,e){if(i&1){let o=C();n(0,"div",9)(1,"h3",31),l(2,"Enter address manually"),t(),n(3,"button",32),p("click",function(){x(o);let d=f();return g(d.useManualEntry=!1)}),l(4," \u2190 Use saved address "),t()()}}function Z(i,e){i&1&&s(0,"i",16)}function ee(i,e){i&1&&s(0,"i",16)}function te(i,e){i&1&&(n(0,"small",22),l(1," Please enter your address details. "),t())}function ie(i,e){i&1&&(n(0,"small",22),l(1," Please enter a valid Egyptian phone number. "),t())}function ne(i,e){i&1&&(n(0,"small",22),l(1," Please enter your city name. "),t())}function re(i,e){i&1&&(n(0,"span"),s(1,"i",46),l(2,"Pay with Stripe"),t())}function oe(i,e){i&1&&(n(0,"span"),s(1,"i",47),l(2,"Place Order"),t())}function le(i,e){i&1&&(n(0,"div",29),l(1," Please fill all required fields correctly. "),t())}var E=class i{_Router=h(N);_ActivatedRoute=h(V);_OrdersServices=h(S);_AddressesService=h(B);cartId="";shippingDetails={};addressesList=[];selectedAddressId=null;useManualEntry=!1;paymentMethod="stripe";getUserAddressesSubscription;ngOnInit(){this._ActivatedRoute.paramMap.subscribe({next:e=>{this.cartId=e.get("id"),console.log(this.cartId)},error:e=>{console.log(e)}}),localStorage.getItem("userToken")&&(this.getUserAddressesSubscription=this._AddressesService.getUserAddresses().subscribe({next:e=>{this.addressesList=e.data||[]},error:e=>console.log(e)}))}orders=new X({details:new O(null,_.required),phone:new O(null,[_.required,_.pattern(/^01[0125][0-9]{8}$/)]),city:new O(null,_.required)});goBackToCart(){this._Router.navigate(["/cart"])}selectAddress(e){this.selectedAddressId=e._id,this.useManualEntry=!1,this.orders.patchValue({details:e.details,phone:e.phone,city:e.city})}toggleManualEntry(){this.useManualEntry=!0,this.selectedAddressId=null,this.orders.reset()}onCheckout(){this.orders.valid?(this.shippingDetails=this.orders.value,this.paymentMethod==="stripe"?this._OrdersServices.checkOut(this.cartId,this.shippingDetails).subscribe({next:e=>{console.log(e),e.status==="success"&&window.open(e.session.url,"_self")},error:e=>{console.log(e)}}):this.paymentMethod==="cash"&&this._OrdersServices.cashOnDelivery(this.cartId,this.shippingDetails).subscribe({next:e=>{console.log(e),e.status==="success"&&this._Router.navigate(["/allorders"])},error:e=>{console.log(e)}})):this.orders.markAllAsTouched()}ngOnDestroy(){this.getUserAddressesSubscription?.unsubscribe()}static \u0275fac=function(o){return new(o||i)};static \u0275cmp=A({type:i,selectors:[["app-orders"]],standalone:!0,features:[P],decls:53,vars:15,consts:[[1,"min-h-screen","bg-gradient-to-b","from-[#0c021a]","via-[#1a0f2d]","to-[#251a3f]"],[1,"container","mx-auto","px-6","py-24","max-w-3xl"],[1,"mb-8","flex","flex-col","items-center"],[1,"w-16","h-16","bg-white/20","rounded-full","flex","items-center","justify-center","text-3xl","font-bold"],[1,"text-white"],[1,"mt-3","text-2xl","font-semibold","tracking-wide","text-white"],[1,"bg-white/10","backdrop-blur-xl","border","border-white/10","rounded-xl","shadow-lg","p-6"],[1,"text-xl","font-semibold","text-white","mb-6"],[1,"mb-6"],[1,"mb-4","flex","items-center","justify-between"],[1,"text-base","font-medium","text-gray-300","mb-4"],[1,"grid","grid-cols-2","gap-3"],["type","button",1,"p-4","rounded-lg","border-2","transition-all","cursor-pointer",3,"click"],[1,"flex","flex-col","items-center","gap-2"],[1,"fas","fa-credit-card","text-2xl","text-violet-400"],[1,"text-sm","font-medium","text-white"],[1,"fas","fa-check-circle","text-violet-400","text-sm"],[1,"fas","fa-money-bill-wave","text-2xl","text-violet-400"],[1,"space-y-4",3,"formGroup"],[1,"group"],[1,"block","text-sm","text-gray-400","mb-2"],["formControlName","details","type","text","placeholder","Street, Building, Apartment...",1,"w-full","p-3","rounded-xl","bg-[#12071F]","text-gray-100","placeholder-gray-500","border","border-violet-800","focus:border-violet-400","outline-none","transition-all","duration-200"],[1,"text-rose-500","text-xs","mt-1","block"],["formControlName","phone","type","text","placeholder","01XXXXXXXXX",1,"w-full","p-3","rounded-xl","bg-[#12071F]","text-gray-100","placeholder-gray-500","border","border-violet-800","focus:border-violet-400","outline-none","transition-all","duration-200"],["formControlName","city","type","text","placeholder","Cairo, Alexandria, etc.",1,"w-full","p-3","rounded-xl","bg-[#12071F]","text-gray-100","placeholder-gray-500","border","border-violet-800","focus:border-violet-400","outline-none","transition-all","duration-200"],[1,"flex","flex-col","sm:flex-row","gap-4","pt-4"],["type","button",1,"w-full","sm:w-1/2","flex","items-center","justify-center","gap-2","bg-violet-800/50","text-violet-200","border","border-violet-700","rounded-xl","py-3","font-medium","hover:bg-violet-700/60","hover:text-white","transition","duration-200","cursor-pointer",3,"click"],[1,"fa-solid","fa-cart-shopping"],["type","button",1,"w-full","sm:w-1/2","bg-gradient-to-r","from-violet-600","to-fuchsia-700","text-white","border","border-green-200","rounded-xl","py-3","font-semibold","shadow-md","hover:shadow-lg","hover:brightness-110","active:scale-[0.98]","transition-all","duration-300","disabled:opacity-50","disabled:cursor-not-allowed","cursor-pointer",3,"click","disabled"],[1,"mt-6","text-center","text-sm","text-rose-400","bg-rose-900/20","border","border-rose-700/60","rounded-xl","py-2","animate-pulse"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-base","font-medium","text-gray-300"],["type","button",1,"text-sm","text-violet-400","hover:text-violet-300","transition","cursor-pointer",3,"click"],[1,"grid","gap-3","mb-4"],[1,"p-4","rounded-lg","border-2","transition-all","cursor-pointer","group",3,"class"],[1,"p-4","rounded-lg","border-2","transition-all","cursor-pointer","group",3,"click"],[1,"flex","items-start","gap-3"],[1,"w-8","h-8","rounded-lg","bg-violet-600/20","flex","items-center","justify-center","flex-shrink-0"],[1,"fas","fa-map-marker-alt","text-sm","text-violet-400"],[1,"flex-1","min-w-0"],[1,"text-sm","font-semibold","text-white","mb-1"],[1,"text-xs","text-gray-400","line-clamp-1"],[1,"flex","gap-4","mt-2","text-xs","text-gray-400"],[1,"fas","fa-city","mr-1"],[1,"fas","fa-phone","mr-1"],[1,"fas","fa-check-circle","text-violet-400"],[1,"fas","fa-credit-card","mr-2"],[1,"fas","fa-money-bill-wave","mr-2"]],template:function(o,r){if(o&1&&(n(0,"section",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"span",4),l(5,"\u{1F6CD}\uFE0F"),t()(),n(6,"h1",5),l(7,"eShop"),t()(),n(8,"div",6)(9,"h2",7),l(10," Shipping Information "),t(),c(11,Q,9,0,"div",8)(12,W,5,0,"div",9),n(13,"div",8)(14,"h3",10),l(15,"Payment Method"),t(),n(16,"div",11)(17,"button",12),p("click",function(){return r.paymentMethod="stripe"}),n(18,"div",13),s(19,"i",14),n(20,"span",15),l(21,"Stripe"),t(),c(22,Z,1,0,"i",16),t()(),n(23,"button",12),p("click",function(){return r.paymentMethod="cash"}),n(24,"div",13),s(25,"i",17),n(26,"span",15),l(27,"Cash on Delivery"),t(),c(28,ee,1,0,"i",16),t()()()(),n(29,"form",18)(30,"div",19)(31,"label",20),l(32,"Address Details"),t(),s(33,"input",21),c(34,te,2,0,"small",22),t(),n(35,"div",19)(36,"label",20),l(37,"Phone Number"),t(),s(38,"input",23),c(39,ie,2,0,"small",22),t(),n(40,"div",19)(41,"label",20),l(42,"City"),t(),s(43,"input",24),c(44,ne,2,0,"small",22),t(),n(45,"div",25)(46,"button",26),p("click",function(){return r.goBackToCart()}),s(47,"i",27),l(48," Back to Cart "),t(),n(49,"button",28),p("click",function(){return r.onCheckout()}),c(50,re,3,0,"span")(51,oe,3,0,"span"),t()()(),c(52,le,2,0,"div",29),t()()()),o&2){let d,u,b;a(11),m(r.addressesList.length>0&&!r.useManualEntry?11:-1),a(),m(r.addressesList.length>0&&r.useManualEntry?12:-1),a(5),y(r.paymentMethod==="stripe"?"bg-violet-600/30 border-violet-500":"bg-white/5 border-white/10 hover:border-violet-500/50"),a(5),m(r.paymentMethod==="stripe"?22:-1),a(),y(r.paymentMethod==="cash"?"bg-violet-600/30 border-violet-500":"bg-white/5 border-white/10 hover:border-violet-500/50"),a(5),m(r.paymentMethod==="cash"?28:-1),a(),k("formGroup",r.orders),a(5),m((d=r.orders.get("details"))!=null&&d.invalid&&((d=r.orders.get("details"))!=null&&d.touched)?34:-1),a(5),m((u=r.orders.get("phone"))!=null&&u.invalid&&((u=r.orders.get("phone"))!=null&&u.touched)?39:-1),a(5),m((b=r.orders.get("city"))!=null&&b.invalid&&((b=r.orders.get("city"))!=null&&b.touched)?44:-1),a(5),k("disabled",r.orders.invalid),a(),m(r.paymentMethod==="stripe"?50:51),a(2),m(r.orders.invalid&&r.orders.touched?52:-1)}},dependencies:[q,$,j,H,U,G,L,F],styles:["[_nghost-%COMP%]{display:block;animation:_ngcontent-%COMP%_fadeIn .5s ease-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}.animate-fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .8s ease-out}.animate-fade-in-slow[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn 1s ease-out}input[_ngcontent-%COMP%]:focus{--tw-border-opacity: 1;border-color:rgb(167 139 250 / var(--tw-border-opacity, 1))}@media (max-width: 640px){.max-w-md[_ngcontent-%COMP%]{padding:1.5rem}}"]})};var we=[{path:"",component:E}];export{we as ORDERS_ROUTES};
