import{a as z,b as N,c as B,d as U}from"./chunk-IGBSAWKS.js";import"./chunk-XAZLOLJU.js";import{a as j}from"./chunk-SWI6CKAI.js";import{a as V}from"./chunk-3JAUR3ZF.js";import{a as O}from"./chunk-GJUGTRZB.js";import{a as q}from"./chunk-BKC52ORT.js";import{a as R}from"./chunk-RUKYRDPX.js";import"./chunk-SZXLN6HP.js";import{$a as P,A as w,Aa as d,Ba as _,Ca as F,H as h,I as f,Ia as I,Ja as A,Ka as E,S,T as x,W as n,ca as b,da as T,ea as u,gb as $,ia as g,ja as k,ka as v,la as C,ma as o,na as a,oa as m,qb as W,ra as D,sa as y,sb as L,ta as l,tb as M,z as c}from"./chunk-ABLYTEQI.js";import"./chunk-EQDQRRRY.js";var G=(i,e)=>e._id,K=i=>["/categories",i],Q=()=>[1,2,3,4,5];function X(i,e){if(i&1&&(o(0,"a",10)(1,"div",11),m(2,"img",12),a(),o(3,"div",13),d(4),a()()),i&2){let t=l().$implicit;u("routerLink",E(4,K,t._id)),n(2),u("src",t.image,x)("alt",t.name),n(2),_(t.name)}}function Y(i,e){i&1&&b(0,X,5,6,"ng-template",9)}function Z(i,e){if(i&1&&(o(0,"div",2)(1,"h2",7),d(2," Explore Featured Categories "),a(),o(3,"owl-carousel-o",8),v(4,Y,1,0,null,9,G),a()()),i&2){let t=l();n(3),u("options",t.categorySliderOptions),n(),C(t.categories)}}function tt(i,e){if(i&1&&(o(0,"div",3),m(1,"img",14),o(2,"h1",15),d(3),a()()),i&2){let t=l();n(),u("src",t.category.image,x)("alt",t.category.name),n(2),_(t.category.name)}}function et(i,e){i&1&&(o(0,"div",4),m(1,"i",16),a())}function it(i,e){i&1&&(o(0,"div",5),d(1,"No products were found for this category."),a())}function rt(i,e){if(i&1&&m(0,"i",28),i&2){let t=e.$implicit,r=l().$implicit,s=l(2);T("style",s.starFill(r.ratingsAverage,t),S)}}function ot(i,e){if(i&1){let t=D();o(0,"div",18),y("click",function(){let s=h(t).$implicit,p=l(2);return f(p.onProductClick(s._id))}),o(1,"div",19),m(2,"img",20),o(3,"div",21)(4,"button",22),y("click",function(s){let p=h(t).$implicit;return l(2).onAddToCart(p._id,p.title),f(s.stopPropagation())}),m(5,"i",23),a(),o(6,"button",22),y("click",function(s){let p=h(t).$implicit;return l(2).onAddToWishlist(p,p.title),f(s.stopPropagation())}),m(7,"i",24),a()()(),o(8,"div",25)(9,"div",26),d(10),a(),o(11,"div",27),v(12,rt,1,1,"i",28,k),o(14,"span",29),d(15),a()(),o(16,"div",30)(17,"span",31),d(18),a(),o(19,"span",32),d(20,"View \u2192"),a()()()()}if(i&2){let t=e.$implicit,r=l(2);n(2),u("src",t.imageCover,x)("alt",t.title),n(5),u("ngClass",r.isWishlisted(t._id)?"fas text-rose-400":"far text-violet-200"),n(3),_(t.title),n(2),C(A(6,Q)),n(3),_((t.ratingsAverage==null?null:t.ratingsAverage.toFixed(1))||"\u2014"),n(3),F("$",t.price,"")}}function nt(i,e){if(i&1&&(o(0,"div",6),v(1,ot,21,7,"div",17,G),a()),i&2){let t=l();n(),C(t.products)}}var H=class i{_Route=c(W);_Categories=c(j);_Products=c(V);_Cart=c(O);_Wishlist=c(q);_Alert=c(R);_Router=c(L);trimPipe=new U;isLoading=!0;errorMsg="";category=null;products=[];categories=[];wishlistIds=new Set;categorySliderOptions={loop:!0,mouseDrag:!0,touchDrag:!0,pullDrag:!1,dots:!0,autoplay:!0,autoplayTimeout:2500,autoplayHoverPause:!0,navSpeed:700,responsive:{0:{items:2},640:{items:3},1024:{items:5}},nav:!1};ngOnInit(){this._Route.paramMap.subscribe(e=>{let t=e.get("id");this.fetchCategory(t),this.fetchProducts(t)}),this._Categories.getAllCategories().subscribe({next:e=>this.categories=e?.data||[]}),localStorage.getItem("userToken")&&this._Wishlist.getWishlist().subscribe({next:e=>{let t=e?.data||[];this.wishlistIds=new Set(t.map(r=>r?._id||r?.id||r?.product?._id).filter(Boolean))}})}fetchCategory(e){this._Categories.getCategorie(e).subscribe({next:t=>{this.category=t?.data},error:t=>{this.errorMsg=t?.error?.message||"Failed to load category"}})}fetchProducts(e){this.isLoading=!0,this._Products.getProductsByCategory(e).subscribe({next:t=>{this.products=t?.data||[],this.isLoading=!1},error:()=>{this.isLoading=!1}})}onProductClick(e){this._Router.navigate(["products","product-details",e])}onAddToCart(e,t){if(!localStorage.getItem("userToken")){this._Router.navigate(["login"]);return}this._Cart.addProductToCart(e).subscribe({next:r=>{let s=this.trimPipe.transform(t,3);this._Alert.toast(`"${s}"<br> Added To Cart`,"success")},error:()=>this._Alert.toast("Failed to add item","error")})}onAddToWishlist(e,t){if(!localStorage.getItem("userToken")){this._Router.navigate(["login"]);return}this.isWishlisted(e._id)?this._Wishlist.removeFromWishlist(e._id).subscribe({next:()=>{this.wishlistIds.delete(e._id),this._Alert.toast(`"${t}" removed from wishlist`,"info")},error:()=>this._Alert.toast("Failed to remove from wishlist","error")}):this._Wishlist.addToWishlist(e._id).subscribe({next:()=>{this.wishlistIds.add(e._id),this._Alert.toast(`"${t}" added to wishlist \u2764\uFE0F`,"success")},error:()=>this._Alert.toast("Failed to add to wishlist","error")})}isWishlisted(e){return this.wishlistIds.has(e)}starFill(e,t){let s=Math.min(Math.max((typeof e=="number"?e:0)-(t-1),0),1)*100;return`background: linear-gradient(90deg, #facc15 ${s}%, #9ca3af ${s}%); -webkit-background-clip: text; -webkit-text-fill-color: transparent;`}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=w({type:i,selectors:[["app-category-details"]],standalone:!0,features:[I],decls:7,vars:5,consts:[[1,"min-h-screen","bg-gradient-to-b","from-[#0c021a]","via-[#1a0f2d]","to-[#251a3f]","text-gray-100","pt-28","md:pt-32","pb-16"],[1,"container","mx-auto","px-4"],[1,"mb-8"],[1,"mb-8","flex","items-center","gap-4"],[1,"flex","items-center","justify-center","py-20"],[1,"text-center","py-20","text-white/80"],[1,"grid","grid-cols-1","sm:grid-cols-2","lg:grid-cols-4","gap-6"],[1,"text-2xl","md:text-3xl","font-bold","text-white","mb-4","tracking-wide","text-center","md:text-left"],[3,"options"],["carouselSlide",""],[1,"block","group",3,"routerLink"],[1,"overflow-hidden","rounded-xl","border","border-white/10","bg-white/5","backdrop-blur-sm"],[1,"w-full","h-28","object-cover","transition","duration-700","group-hover:scale-110",3,"src","alt"],[1,"mt-2","text-center","text-white/80","text-sm","group-hover:text-violet-300","transition"],[1,"w-16","h-16","object-cover","rounded-lg","border","border-white/10",3,"src","alt"],[1,"text-2xl","md:text-3xl","font-bold","text-white"],[1,"fas","fa-spinner","fa-spin","text-violet-300","text-2xl"],[1,"group","bg-white/5","border","border-white/10","rounded-xl","overflow-hidden","hover:shadow-xl","hover:shadow-violet-900/20","transition-all","duration-500","cursor-pointer"],[1,"group","bg-white/5","border","border-white/10","rounded-xl","overflow-hidden","hover:shadow-xl","hover:shadow-violet-900/20","transition-all","duration-500","cursor-pointer",3,"click"],[1,"relative","aspect-square","overflow-hidden"],[1,"w-full","h-full","object-cover","transition","duration-700","group-hover:scale-105",3,"src","alt"],[1,"absolute","inset-0","bg-black/40","opacity-0","group-hover:opacity-100","transition-all","duration-300","flex","items-center","justify-center","gap-4"],[1,"p-3","rounded-full","cursor-pointer","bg-[#1b1330]/90","hover:bg-violet-700","text-white","shadow-md","transition-all","duration-300",3,"click"],[1,"fas","fa-shopping-cart"],[1,"fa-heart",3,"ngClass"],[1,"p-4"],[1,"font-medium","text-white","mb-1","line-clamp-1"],[1,"flex","items-center","gap-1","mb-2"],[1,"fas","fa-star","text-sm"],[1,"text-xs","text-gray-300","ml-1"],[1,"flex","items-center","justify-between"],[1,"text-violet-300","font-semibold"],[1,"text-sm","text-violet-300","group-hover:text-violet-200"]],template:function(t,r){t&1&&(o(0,"section",0)(1,"div",1),b(2,Z,6,1,"div",2)(3,tt,4,3,"div",3)(4,et,2,0,"div",4)(5,it,2,0,"div",5)(6,nt,3,0,"div",6),a()()),t&2&&(n(2),g(r.categories.length?2:-1),n(),g(r.category?3:-1),n(),g(r.isLoading?4:-1),n(),g(!r.isLoading&&r.products.length===0?5:-1),n(),g(!r.isLoading&&r.products.length>0?6:-1))},dependencies:[$,P,B,N,z,M]})};export{H as CategoryDetailsComponent};
